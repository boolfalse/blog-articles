
## Execution Context, ีีพีตีกีฌีถีฅึีซ ีบีกีฐีบีกีถีธึีด (ีดีกีฝ 3/7)

### NGNTJS - ีดีกีฝ 3

---

NGNTJS ีฐีธีคีพีกีฎีกีทีกึีซ ีถีกีญีธึีค [ีดีกีฝ 2](https://medium.com/@boolfalse/javascript-engine-%D5%B6%D5%B7%D5%A1%D5%B6%D5%A1%D5%AF%D5%B8%D6%82%D5%A9%D5%B5%D5%B8%D6%82%D5%B6%D5%A8-%D6%87-%D5%AF%D5%A1%D5%BC%D5%B8%D6%82%D6%81%D5%BE%D5%A1%D5%AE%D6%84%D5%A8-d900993ba01b)ึีธึีด ีถีฅึีฏีกีตีกึีพีฅึ JavaScript engineึีถีฅึีซ ีถีทีกีถีกีฏีธึีฉีตีธึีถีจ ึ ีฏีกีผีธึึีพีกีฎึีจึ
ิฑีตีฝ ีดีกีฝีธึีด ีฏีกีถึีถีฅีถึ JavaScriptึีซ ีกีทีญีกีฟีกีถึีซ ีธึีฝีธึีดีถีกีฝีซึีดีกีถีจึ ิฟีถีฅึีฏีกีตีกึีถีฅีถึ Execution contextึีจ ึ ีฟีพีตีกีฌีถีฅึีซี ึีธึีธีญีกีฏีกีถีถีฅึีซ ึ ึีธึีถีฏึีซีกีถีฅึีซ (first-class citizens) ีบีกีฐีบีกีถีธึีดีจึ ิธีถีฉีกึีธึีด ีฏีกีผีถีนีพีฅีถึ ีกีตีถีบีซีฝีซ ีฟีฅึีดีซีถีถีฅึีซ, ีซีถีนีบีซีฝีซึ ีฅีถ call stackึีจ, ึีธึีธีญีกีฏีกีถีถีฅึีซ ีฟีซีบีฅึีจ, hoistingึีจ ึ ีกีตีฌีถึ

<img src="https://i.imgur.com/rAtZenX.png" style="width:100%;">
 
[ีีฏีกึีจี [unsplash.com](https://unsplash.com/photos/a-room-with-wooden-walls-and-black-curtains-iiFnnqiPhFw)]

JavaScript-ีจ single-threaded ีฌีฅีฆีธึ ีง, ีฐีกีดีกึีฅีฌีธีพ ีกีตีฝีฟีฅีฒ threadึีจ ีธึีบีฅีฝ ีฒีฅีฏีกีพีกึีดีกีถ ีฐึีกีดีกีถีถีฅึีซ ีฃีฎีกีตีซีถ ีฐีฅึีฉีกีฏีกีถีธึีฉีตีกีดีข (single sequential flow of control)ึ
JavaScriptึีจ ีถีกึ synchronous language ีง, ีขีกีตึ ีธึีถีซ asynchronous ีฐีถีกึีกีพีธึีธึีฉีตีธึีถีถีฅึ, ีธึีถ ีฝีฟีกึีพีธึีด ีง out-of-the-boxึ
Threadึีจ ีธึีจ ีฝีฟีฅีฒีฎีพีธึีด ีง JavaScript ีฏีธีคีซ ีกีทีญีกีฟีฅึีดีกีถ ีชีกีดีกีถีกีฏ, ีฏีซึีกีผีธึีด ีง Call Stack (Last In First Out ีฝีฏีฆีขีธึีถึีธีพ ีกีทีญีกีฟีธีฒ ีฐึีกีดีกีถีถีฅึีซ ีบีกีฐีธึ) ึ Memory Heap (ีฐีซีทีธีฒีธึีฉีตีกีถ ีฟีกึีกีฎึ arrayึีถีฅึีซ, objectึีถีฅึีซ, functionึีถีฅึีซ ีฐีกีดีกึ)ึ

Call Stack-ีจ ีคีก ีฟีพีตีกีฌีถีฅึีซ ีฏีกีผีธึึีพีกีฎึ ีง (data structure), ีธึีธึีด ีงีฌีฅีดีฅีถีฟีถีฅึีจ ีบีกีฐีพีธึีด ีฅีถ LIFO ีฝีฏีฆีขีธึีถึีธีพึ

Javascript codeึีจ ีกีทีญีกีฟีฅึีถีฅีฌีธึึ ีฝีฟีฅีฒีฎีพีธึีด ีง ีดีซีปีกีพีกีตึ, ีธึีฟีฅีฒ ีฏีกีฟีกึีพีธึีด ีง ีฏีธีคีซ ีฟึีกีถีฝึีธึีดีกึีซีกีถ (interpretationึีจ ึ ีดีถีกึีกีฎีจ) ึ executionึีจึ ิฑีตีค ีดีซีปีกีพีกีตึีจ ีฏีธีนีพีธึีด ีง Global Execution Context: ีึีก ีดีฅีป ีง ีฃีฟีถีพีธึีด ีกีทีญีกีฟีธีฒ ีจีถีฉีกึีซีฏ ีฏีธีคีจ ึ ีกีตีถ ีกีดีฅีถีจ ีซีถีน ีฏีกีบีพีกีฎ ีง ีคึีก ีฐีฅีฟึ ิฒีกึีซ Global ECึีซึ, ีตีธึึีกึีกีถีนีตีธึึ ีฏีกีถีนีพีกีฎ JavaScript ึีธึีถีฏึีซีก ีธึีถีฅีถีธึีด ีง ีซึ ECึีจี
Function Execution Contextึ

ีีกีถีฏีกึีกีฎ EC ีฝีฟีฅีฒีฎีพีฅีฌีธึึ (Global EC ีฏีกีด Function EC) ีฟีฅีฒีซ ีง ีธึีถีฅีถีธึีด ีฐีกีปีธึีคีกีฏีกีถ ีฅึีฏีธึ ึีธึีฌึ

A. **Memory creation phase** (ีีซีทีธีฒีธึีฉีตีกีถ ีฝีฟีฅีฒีฎีดีกีถ ึีธึีฌ)

- ีีฟีฅีฒีฎีพีธึีด ีง ีฃีฌีธีขีกีฌ ึีขีตีฅีฏีฟึ ีึีซีถีกีฏี V8 engineึีธีพ ีกีทีญีกีฟีธีฒ Chromeึีธึีด ีฃีฌีธีขีกีฌ ึีขีตีฅีฏีฟีจ windowึีถ ีง, ีซีฝีฏ Node.jsึีธึีดี globalึีจึ
- ีีฟีฅีฒีฎีพีธึีด ีง this ึีขีตีฅีฏีฟีจ ึ ีคึีกีถ ีธึีบีฅีฝ ีกึีชีฅึ ีฟึีพีธึีด ีง ีฃีฌีธีขีกีฌ ึีขีตีฅีฏีฟีซ ีฐีฒีธึีดีจึ ีึีซีถีกีฏี Chromeึีธึีด ึีกีถีฏีกึีกีฎ ีงีปีธึีด ีฏีกีถีนีฅีฌีธีพ thisึีจี ีฏีฝีฟีกีถีกีถึ ีถีธึีตีถ windowึีซ ึีขีตีฅีฏีฟีจึ
- ีีกีฐีพีธึีด ีฅีถ ีฃีฌีธีขีกีฌ ECึีธึีด ีฃีฟีถีพีธีฒ ีขีธีฌีธึ ึีธึีธีญีกีฏีกีถีถีฅึีจ (ีธึีบีฅีฝ undefined) ึ ึีธึีถีฏึีซีกีถีฅึีซ ีฐีฒีธึีดีถีฅึีจ (ีธีฒีป ึีธึีถีฏึีซีกีถ ีบีกีฐีพีธึีด ีง memory heap-ีธึีด)ึ

B. **Execution phase** (ิฑีทีญีกีฟีฅึีดีกีถ ึีธึีฌ)

- ิฟีธีคีจ ีกีทีญีกีฟีฅึีพีธึีด ีง ีฟีธีฒ ีกีผ ีฟีธีฒึ
- ีีธีฒ ีกีผ ีฟีธีฒ ีกีทีญีกีฟีฅึีดีกีถ ีชีกีดีกีถีกีฏ ึีกีถีฏีกึีกีฎ ึีธึีถีฏึีซีกีตีซ  ีฐีกีดีกึ ีฝีฟีฅีฒีฎีพีธึีด ีง ีฐีกีดีกีบีกีฟีกีฝีญีกีถ ECึ

ีึีบีฅีฝ ึึีซีถีกีฏ ีพีฅึึีถีฅีถึ ีฐีฅีฟึีตีกีฌ ีฏีธีค ีขีฌีธีฏีจ ึ ีธึีฝีธึีดีถีกีฝีซึีฅีถึ Global Execution Contextึีซ 2 ึีธึีฌีฅึีจโค

```javascript
var x = 2;
var y = 3;
function multiply(a, b) {
  var m = a * b;
  return m;
}
var z = multiply(x, y);
```

ิฒีกึีกีฟึีฅีถึ ีกีตีฝ ึึีซีถีกีฏีจึ
ิปีถีนีบีฅีฝ ีกึีคีฅีถ ีกีฝีพีฅึ, ีฝีฏีฆีขีธึีด ีฏีฝีฟีฅีฒีฎีพีซ Global EC (ีกีตีถ "ีฏีฟีฅีฒีกีคึีพีซ" Call Stackึีธึีด): Creation phaseึีธึีด x ึีธึีธีญีกีฏีกีถีซ ีฐีกีดีกึ ีฏีกีฆีกีฟีพีซ ีฐีซีทีธีฒีธึีฉีตีกีถ ีฟีกึีกีฎึ (memory allocation) ึ memory heapึีธึีด ีธึีบีฅีฝ ีกึีชีฅึ ีฏีฝีฟีกีถีก undefinedึ
y ึีธึีธีญีกีฏีกีถีซ ีฐีกีดีกึ ีฏีกีฆีกีฟีพีซ ีฐีซีทีธีฒีธึีฉีตีกีถ ีฟีกึีกีฎึ ึ memory heapึีธึีด ีธึีบีฅีฝ ีกึีชีฅึ ีฏีฝีฟีกีถีก undefinedึ
multiply ึีธึีถีฏึีซีกีตีซ ีฐีกีดีกึ ีฏีกีฆีกีฟีพีซ ีฐีซีทีธีฒีธึีฉีตีกีถ ีฟีกึีกีฎึ ึ memory heapึีธึีด ีธึีบีฅีฝ ีกึีชีฅึ ีฏีฝีฟีกีถีก ีธีฒีป ึีธึีถีฏึีซีกีถ: ิฑีตีฝีซีถึีถี ีฐีกีดีกึีฅีฌีธีพ ีธึีบีฅีฝ key:value pair, ึีธึีถีฏึีซีกีตีซ ีกีถีธึีถีจ ีฏีบีกีฐีพีซ ีธึีบีฅีฝ ีฐีฒีธึีด memory heapึีซ ีฐีกีดีกีบีกีฟีกีฝีบีญีกีถ ึีธึีถึีซีกีตีซ ีพึีกึ
z ึีธึีธีญีกีฏีกีถีซ ีฐีกีดีกึ ีฏีกีฆีกีฟีพีซ ีฐีซีทีธีฒีธึีฉีตีกีถ ีฟีกึีกีฎึ ึ memory heapึีธึีด ีธึีบีฅีฝ ีกึีชีฅึ ีฏีฝีฟีกีถีก undefinedึ

ิตึีฏึีธึีค (ีฏีกีฟีกึีดีกีถ) ึีธึีฌีธึีด ีกีผีกีปีซีถ ีฟีธีฒีซึ ีฝีฏีฝีกีฎ x-ีจ ีฏีฝีฟีกีถีก 2 ีกึีชีฅึ, y-ีจ ีฏีฝีฟีกีถีก 3 ีกึีชีฅึึ ีีธึีถีฏึีซีกีตีซีถ ีฐีกีฝีถีฅีฌีธีพ ีธีน ีดีซ execution ีฟีฅีฒีซ ีนีซ ีธึีถีฅีถีก, ีซีฝีฏ ีพีฅึีปีซีถ ีฟีธีฒีธึีด multiply ึีธึีถีฏึีซีกีถ invoke ีฏีกึีพีซ (ีฏีฏีกีถีนีพีซ)ึ ีีฅีฟึีกีขีกึ ีฏีฝีฟีฅีฒีฎีพีซ Function EC:

multiply ึีธึีถีฏึีซีกีตีซ ECึีธึีด ีถีดีกีถีกีฟีซีบ ีกีถีกีฌีธีฃีซีกีตีธีพ ีฝีฏีฆีขีธึีด ีฟีฅีฒีซ ีฏีธึีถีฅีถีก memory creation phaseึีจี a ึ b, ีกีตีถีธึีฐีฅีฟึ m ึีธึีธีญีกีฏีกีถีถีฅึีซ ีฐีกีดีกึ ีฐีซีทีธีฒีธึีฉีตีธึีถ ีฏีฟึีกีดีกีคึีพีซ ึ ีถึีกีถึ ีฏีฟึีพีซ undefined ีกึีชีฅึึ ีีฅีฟีธ ีฟีฅีฒีซ ีฏีธึีถีฅีถีก execution phaseึีจ, ีธึีฟีฅีฒ a-ีถ ีฏีฝีฟีกีถีก 2 ีกึีชีฅึ, bึีถ ีฏีฝีฟีกีถีก 3 ีกึีชีฅึ, ีกีตีถีธึีฐีฅีฟึ mึีจ ีฏีฝีฟีกีถีก 6 ีกึีชีฅึ (2*3): ีีธึีถีฏึีซีกีถ ีฏีพีฅึีกีคีกึีฑีถีซ ีกึีชีฅึีจ Function ECึีซึ ีคีฅีบีซ Global EC ึ ีกีตีค Function ECึีถ ีฏีปีถีปีพีซ Call Stackึีซึึ ีีฅึีกีคีกีผีถีกีฌีธีพ Global EC, zึีจ ีฏีฝีฟีกีถีก ีพีฅึีกีคีกึีฑีพีกีฎ 6 ีกึีชีฅึีจึ ีีฅึีปีกีบีฅีฝ Call Stackึีซึ ีฏีปีถีปีพีซ ีถีกึ Global ECึีจ ึ ีกีตีฝีบีซีฝีธีพ ีฎึีกีฃีซึีจ ีฏีกีพีกึีฟีพีซ (ีนีฅีถึ ีญีธีฝีธึีด [garbage collector](https://v8.dev/blog/trash-talk)ึีซ ีกีทีญีกีฟีกีถึีซ ีดีกีฝีซีถ)ึ

ิฟีกึีฅีฌีซ ีง ีพีฅึีปีซีถีฝ ีถีฏีกึีกีฃึีฅีฌ ีฐีฅีฟึีตีกีฌ ีบีกีฟีฏีฅึีธีพโค

<img src="https://i.imgur.com/3Lr0qgJ.gif" style="width:100%;">
 
[JavaScript Execution Contextึีซ ีกีทีญีกีฟีกีถึีซ ึึีซีถีกีฏ]

ิบีกีดีกีถีกีฏีกีฏีซึ web browserึีถีฅึีธึีด ึีฃีฟีกีฃีธึีฎีฅีฌีธีพ debuggerึีจ ีดีฅีถึ ีฏีกึีธีฒ ีฅีถึ ีฟึีพีกีฎ ีฏีธีคีซ execution phaseึีซีถ ีฐีฅีฟึีฅีฌ, ึีกีตีฌ ีกีผ ึีกีตีฌ ีกีถึีถีฅีฌีธีพ ีฏีธีคีซ ีฐึีกีดีกีถีถีฅึีซ ีพึีกีตีธีพึ ีึีซีถีกีฏ Chrome-ีธึีด ีคีก ีฏีกึีฅีฌีซ ีง ีฟีฅีฝีถีฅีฌ ีซีถีนีบีฅีฝ ีบีกีฟีฏีฅึีพีกีฎ ีง ีฝีฟีธึีซีถ ีถีฏีกึีธึีดโค

<img src="https://i.imgur.com/sxiYysL.png" style="width:100%;">
 
[Chromeึีธึีด execution ึีธึีฌีซ ีกีทีญีกีฟีกีถึีซ ึึีซีถีกีฏ]

ิปีถีนีบีฅีฝ ีฅึึีธึีด ีง ีถีฏีกึีธึีด ีถีทีพีกีฎ ีฐีกีฟีพีกีฎีธึีดี Call Stackึีจ ีถีฅึึึีธึีด ีบีกึีธึีถีกีฏีธึีด ีง (anonymous) ีงีฌีฅีดีฅีถีฟ, ีธึีจ Global ECึีถ ีงึ ิปีฝีฏ multiply ึีธึีถีฏึีซีกีถ ีซึ ีฐีฅึีฉีซีถ ีขีกึีฅีฌ ีง ีถีธึ Function EC, ีธึีจ ีกีพีฅีฌีกึีฅีฌ ีง Call Stackึีธึีด, ึ ีถีฏีกึีธึีด ีบีกีฟีฏีฅึีพีกีฎีจ ีฐีฅีถึ ีกีตีถ ีบีกีฐีถ ีง, ีฅึีข threadึีจ ีกีทีญีกีฟีธึีด ีง ึีธึีถีฏึีซีกีตีซ execution contextึีซ ีพึีกึ

ีีกีดีฅีถีกีตีถ ีคีฅีบีฝ Call Stackึีจ ีธึีถีซ ีฝีกีฐีดีกีถ, ึ ีกีตีค ีฝีกีฐีดีกีถีพีกีฎ ีนีกึีจ ีกีถึีถีฅีฌีธีพ ีฏีฝีฟีกีถีกีถึ _Uncaught RangeError_, ีซีถีนีบีฅีฝ ึึีซีถีกีฏ ีฝีฟีธึีซีถ ีถีฏีกึีธึีด ีงโค

<img src="https://i.imgur.com/PwFpapL.png" style="width:100%;">
 
[Uncaught RangeError: Maximum call stack exceeded]

ีีทีฅีถึ ีถีกึ, ีธึ ีฏีกึีธีฒ ีฅีถ ีฌีซีถีฅีฌ ีคีฅีบึีฅึ, ีฅึีข ีฏีธีคีซ executionึีซ ีชีกีดีกีถีกีฏ ีธึีถีฅีถีกีถึ error, ีกีตีค ีคีฅีบึีธึีด ีกีพีฟีธีดีกีฟ ีฟีฅีฒีซ ีฏีธึีถีฅีถีก Call Stackึีซ ีคีกีฟีกึีฏีธึีดึ ีีฟีธึึ ีถีฏีกึีธึีด ีถีฅึีฏีกีตีกึีพีกีฎ ีง consoleึีธึีด call stackึีซ ีกีตีถ ีบีกีฐีจ, ีธึีฟีฅีฒ ีฃึีกีถึีพีฅีฌ ีง errorึีจโค

<img src="https://i.imgur.com/CgvZpKp.png" style="width:100%;">
 
[Uncaught Error - call stackึีซ ีกีพีฟีธีดีกีฟ ีดีกึึีธึีด]

ิฑีตีชีด, ีธึีบีฅีฝีฆีซ ีธึีฝีธึีดีถีกีฝีซึีฅีถึ execution contextึีซ ีตีธึึีกีฐีกีฟีฏีธึีฉีตีธึีถีจ ีกีตีฌ ึึีซีถีกีฏีซ ีพึีก, ีฏีกึีธีฒ ีฅีถึ ีฑึีกึีธีญีฅีฌ ีฏีธีคีจ ึ ีคีซีฟีกึีฏีฅีฌ ีฐีฅีฟึีตีกีฌ ีคีฅีบึีจโค

```javascript
console.log(x, y, multiply);
var x = 2;
var y = 3;
var z = multiply(x, y)
function multiply(a, b) {
  var m = a * b;
  return m;
}
```

ิปีถีนีบีฅีฝ ีฟีฅีฝีถีธึีด ีฅีถึี multiply ึีธึีถีฏึีซีกีถ ีฏีกีถีนีพีธึีด ีง ีถีกีญึีกีถ ีคึีก ีฐีกีตีฟีกึีกึีธึีดีจึ ีีก ีฏีกึีธีฒ ีง ีฌีซีถีฅีฌ ีฟีกึึึีซีถีกีฏ, ีขีกีตึ ีซึีกีฏีกีถีธึีด ึีกีถีซ ีธึ ีดีฅีถึ ีกึีคีฅีถ ีฃีซีฟีฅีถึ execution contextึีซ ีฅึีฏีธึ phaseึีฅึีซ ีดีกีฝีซีถ, ีกีบีก ีฏีกึีธีฒ ีฅีถึ ีฐีกีฝีฏีกีถีกีฌ ีธึ ีกีตีฝ ีฟีฅีฝึีธึีด ีญีถีคีซึ ีนีซ ีฏีกึีธีฒ ีกีผีกีปีกีถีกีฌ, ึีกีถีซ ีธึ ีกีผีกีปีซีถ ึีธึีฌีธึีด initialize ีฅีถ ีกึีพีธึีด xึีจ, yึีจ ึ multiplyึีจ, ีกีบีก ีคึีกีถีซึ ีฐีฅีฟีธ ีถีธึ ีฏีกีฟีกึีพีธึีด ีง execution ึีธึีฌีจ, ีธึีฟีฅีฒ x-ีจ ึ yึีจ ีธึีถีฅีถ undefined ีกึีชีฅึ, ีซีฝีฏ multiply ึีธึีถีฏึีซีกีถ ีกึีคีฅีถ initialize ีง ีฅีฒีฅีฌึ
ีีฟีกึีพีธึีด ีง, ีธึ console.logึีซ ีฏีฟีบีซ ีฐีฅีฟึีตีกีฌ ีกึีคีตีธึีถึีจโค

<img src="https://i.imgur.com/BZrkpMK.png" style="width:100%;">
 
[ีีฏีกึีพีกีฎ ีง Chromeึีซ Inspectึีซึ]

ิฑีตีชีด ีธึีถีฅีถีกีฌีธีพ ีบีกีฟีฏีฅึีกึีธึีด Execution Contextึีซ ีดีกีฝีซีถ, ีฏีกึีฅีฌีซ ีง ีญีธีฝีฅีฌ **Hoisting**ึีซ ีดีกีฝีซีถึ

ิปีถีนีบีฅีฝ ีถีฏีกีฟีฅึีซีถึี ึึีซีถีกีฏีธึีด ีฃึีพีกีฎ ีฏีธีคีธึีด x ึ y ึีธึีธีญีกีฏีกีถีถีฅึีจ ีฐีกีตีฟีกึีกึีพีกีฎ ีฅีถ varึีธีพึ ีีธึีฑีฅีถึ ึีฝ ีดีฅีฏ ีกีถีฃีกีด ีฑึีกึีธีญีฅีฌ ีฏีธีคีจ ึ x ึ y ึีธึีธีญีกีฏีกีถีถีฅึีจ ีฐีกีตีฟีกึีกึีฅีฌีซีฝ varึีซ ึีธีญีกึีฅีถ ึีฃีฟีกีฃีธึีฎีฅีถึ let.

```javascript
console.log(multiply);
console.log(x, y);
let x = 2;
let y = 3;
var z = multiply(x, y);
function multiply(a, b) {
  var m = a * b;
  return m;
}
```

ิฑีตีฝ ีคีฅีบึีธึีด browserึีจ ีดีฅีฆ ีฏีพีฅึีกีคีกึีฑีถีซ _Uncaught ReferenceError_ (ีนีถีกีตีกีฎ ีธึ multiplyึีจ ึีฃีฟีกีฃีธึีฎีฅีฌีธึึ ีกีตีถ ีญีถีคีซึ ีนีซ ีฟีก), ีถีทีฅีฌีธีพ ีธึ errorึีจ ีฃึีกีถึีพีฅีฌ ีง ีซีถีนีบีฅีฝ ีกึีคีฅีถ ีฃีซีฟีฅีถึ <anonymous> ีฏีธีนีพีธีฒ execution contextึีธึีด, 2 ีฟีธีฒีซ 13 ีฝีซีดีพีธีฌีซึ ีฝีฏีฝีกีฎโค

<img src="https://i.imgur.com/JLWUA5k.png" style="width:100%;">
 
[ีีฏีกึีพีกีฎ ีง Chromeึีซ Inspectึีซึ]

ีีกีฝีฟีธึีฅีถ ีดีฅีถึ ีฝีฟีกึีกีถึ error ีฐีฅีถึ ีฅึีฏึีธึีค ึีธึีฌีธึีดี execution phaseึีธึีด JavaScript ีซีถีฟีฅึีบึีฅีฟีกีฟีธึีจ ึีธึีฑีธึีด ีง log ีกีถีฅีฌ ีกึีฃีธึีดีถีฅีฟีธึีด ีฃึีพีกีฎีจ, ึีธึีฑีธึีด ีง ีฃีฟีถีฅีฌ ีคีฅีผ ีกีผีกีปีซีถ (initializeึีซ) ึีธึีฌีธึีด x ีกีถีธึีถีธีพ ีฃึีกีถึีพีกีฎ ึีธึีธีญีกีฏีกีถี ีกีตีคีบีซีฝีซีถ ีนีฏีก, ีฐีฅีฟีธ ึีธึีฑีธึีด ีง ีฃีฟีถีฅีฌ x ีกีถีธึีถีธีพ ีฃึีกีถึีพีกีฎ ึีธึีถีฏึีซีกีตีซ ีฐีฒีธึีด (reference)ี ีคีก ีงีฌ ีนีฏีก, ีนีฃีฟีถีฅีฌีธีพ ีธีน ีดีซ ีฐีฒีธึีด, ีกีตีถ ีฐีฅีฟ ีง ีธึีฒีกึีฏีธึีด _ReferenceError_:

ิฑีตีฝ ีบีกีฐีซีถ ีคีฅีผึีฝ ีนีญีธีฝีกีฌีธีพ Hoistingึีซ ีดีกีฝีซีถ, ีฏีกึีธีฒ ีฅีถึ ีฐีกีฝีฟีกีฟีฅีฌ, ีธึ ีฃีธีตีธึีฉีตีธึีถ ีธึีถีซ ีฟีกึีขีฅึีธึีฉีตีธึีถ varึีซ ึ letึีซ ีดีซีปึี ีกีผีถีพีกีฆีถ ีดีซีถีน ีกีตีฝ ีถีฏีกึีกีฃึีพีกีฎ ึีกีฝีฟีซ ีกีผีธึีดีธีพึ

letึีจ ึ constึีจ JavaScript ีฌีฅีฆีพีธึีด ีฅีถี ีฝีฏีฝีกีฎ ES6ึีซึ (ECMAScript 2015): ิดึีกีถึ ึ varึีซ ีฟีกึีขีฅึีธึีฉีตีธึีถีถีฅึีซึ ีดีฅีฏีถ ีฐีฅีถึ hoistingึีถ ีง: var ึีธึีธีญีกีฏีกีถีถีฅึีจ creation (ีฏีกีด ีฏีกึีฅีฌีซ ีง ีกีฝีฅีฌ initialization) phaseึีธึีด hoist ีฅีถ ีกึีพีธึีด Global scopeึีธึีด ึ ีกึีคีฅีถ execution phaseึีธึีด ีฐีกีฝีกีถีฅีฌีซ ีฅีถ ีฌีซีถีธึีดี ีกึีคีฅีถ ีซีฝีฏ ีพีฅึีกีฃึีพีกีฎ undefined ีกึีชีฅึีธีพ:
ีีถีกีตีกีฎ ีธึ ีทีกีฟ ีกีฒีขีตีธึึีถีฅึีธึีด ีถีทีพีธึีด ีง ีธึ let/const ึีธึีธีญีกีฏีกีถีถีฅึีจ hoist ีนีฅีถ ีกึีพีธึีด, ีฝีกีฏีกีตีถ ีซึีกีฏีกีถีธึีด ีคึีกีถึ hoist ีกึีพีธึีด ีฅีถ, ีขีกีตึ ีคีฅีบีซ _Script scope_, ึ ีกีตีค ีบีกีฟีณีกีผีธีพ execution ึีธึีฌีธึีด ีฐีกีฝีกีถีฅีฌีซ ีนีฅีถ ีฌีซีถีธึีดึ ิดึีก ีฐีกีดีกึ ีงีฌ, ีซ ีฟีกึีขีฅึีธึีฉีตีธึีถ varึีซ` letึีจ ึ constึีจ block-scoped ึีธึีธีญีกีฏีกีถีถีฅึ ีฅีถึ
ีีฟีธึึ ีกีตีถ ึึีซีถีกีฏีถ ีง, ีฅึีข ีดีฅีถึ execution phaseึีธึีด ีธึีถีฅีถึ ีดีซีกึึีกีฎ debugger, ีธึีจ ีฟีพีตีกีฌ ีฟีธีฒีซ ีพึีก (ีฏีกีถีฃีถีฅึีพีกีฎ ีง ึ ีคีฅีผ ีนีซ ึีธึีฑีฅีฌ execute ีกีถีฅีฌ ีกีตีค ีฟีธีฒีจ) ีกึีคีฅีถ ีกึีฑีกีถีกีฃึีธึีด ีง ีธึ ีดีฅึ letึีธีพ ีฐีกึีฟีกึีกึีพีกีฎ ึีธึีธีญีกีฏีกีถีถีฅึีฅึีจ hoist ีฅีถ ีฅีฒีกีฎ _Script scope_ึีธึีด: ิตีพีฝ ีดีฅีฏ ีกีถีฃีกีด ีกึีฑีกีถีกีฃึีฅีถึี ีคึีกีถึ ีฐีกีฝีกีถีฅีฌีธึีฉีตีธึีถีจ execution phaseึีธึีด ึีกีฏ ีง, ีกีตีค ีบีกีฟีณีกีผีธีพ ีดีฅีถึ ีธึีถีฅีถีธึีด ีฅีถึ ีฐีฅีฟึีตีกีฌ errorึีจี
_caught ReferenceError: Cannot access 'x' before initialization at index.html:13:13_

<img src="https://i.imgur.com/ndQwAKa.png" style="width:100%;">
 
[ีีฏีกึีพีกีฎ ีง Chromeึีซ Inspectึีซึ]

ิฑีตีฝีบีซีฝีธีพ, ีดีฅีถึ ีธึีถีฅึีกีถึ ีธึีธีทีกีฏีซ ีบีกีฟีฏีฅึีกึีธึีด JavaScript hoistingึีซ ีดีกีฝีซีถี ีถีกีญึึีธึ ีซีดีกีถีกีฌีธีพ execution phaseึีฅึีซ ีดีกีฝีซีถึ
ิปึีกีฏีกีถีธึีด let/const ึ var ึีธึีธีญีกีฏีกีถีถีฅึีจ ีธึีถีฅีถ ีทีกีฟ ีธึึีซีท ีฟีกึีขีฅึีธึีฉีตีธึีถีถีฅึ ึีฝ, ีธึีธีถึ ีดีกีฝีซีถ ีฏีกึีฅีฌีซ ีง ีฏีกึีคีกีฌ ีฐีฅีฟึีตีกีฌ [freeCodeCamp ีฐีธีคีพีกีฎีธึีด](https://www.freecodecamp.org/news/var-let-and-const-whats-the-difference/) ึ [ีฐีฅีฟึีตีกีฌ stackoverflow ีฐีธีฝึีธึีด](https://stackoverflow.com/a/11444416/7574023):

ิฑีตีชีด ีญีธีฝีฅีถึ ีกีตีถ ีดีกีฝีซีถ, ีฉีฅ ีซีถีนีบีฅีฝ ีง JavaScriptึีจ ีพีกึีพีธึีด ีฟีพีตีกีฌีถีฅึีซ ีฐีฅีฟ, ึ ีธึีฟีฅีฒ ีฅีถ ีคึีกีถึ ีบีกีฐีบีกีถีพีธึีดึ

ิฟีกีญีพีกีฎ ีฟีพีตีกีฌ ีกึีชีฅึีซึี primitive ีฏีกีด reference, ีกีตีถ ีบีกีฐีพีธึีด ีง ีฐีกีดีกีบีกีฟีกีฝีญีกีถีกีขีกึ stackึีธึีด (Call Stack-ีซ ีฐีฅีฟ ีนีทึีธีฉีฅีฌ), ีฏีกีด heapึีธึีดึ

ิฑีตีถีบีซีฝีซ ีฌีฅีฆีธึีถีฅึีธึีด, ีฐีกีดีฅีดีกีฟีกีขีกึ low-level, ีซีถีนีบีซีฝีซึ ีฅีถ Cึีถ ึ C++ึีจ, developerึีจ ีซีถึีถ ีง ีจีถีฟึีธึีด ีฉีฅ ีซีถีน ีฐีซีทีธีฒีธึีฉีตีธึีถ ีฏีกึีฅีฌีซ ีง allocate ีกีถีฅีฌ ีกีตีฝ ีฏีกีด ีกีตีถ ึีขีตีฅีฏีฟีซ ีฐีกีดีกึึ ีีกีดีฅีดีกีฟีกีขีกึ ีกีพีฅีฌีซ high-level ีฌีฅีฆีธึีถีฅึีธึีด, ีซีถีนีบีซีฝีซีถ ีง JavaScriptึีจ ึ Pythonึีจ, ีกีตีฝีฟีฅีฒ ีกีพีฟีธีดีกีฟ ีฐีซีทีธีฒีธึีฉีตีธึีถ ีง allocate ีกึีพีธึีด ีฅึีข ีฝีฟีฅีฒีฎีพีธึีด ีง ึีขีตีฅีฏีฟ, ีกีตีถีธึีฐีฅีฟึ ีกีพีฟีธีดีกีฟ ีดีกึึีธึีด ีง ีกีตีค memoryึีถ ีฅึีข ีคึีกีถึ ีฏีกึีซึีจ ีงีฌ ีนีซ ีฌีซีถีธึีดึ ิดีก ีฏีกีฟีกึีพีธึีด ีง ีถีฅึีคึีพีกีฎ ีฃีธึีฎีซึีซ ีดีซีปีธึีธีพี garbage collectorึ ีีฏีฆีขีธึีด ีถีทีพีกีฎ ีฌีฅีฆีธึีถีฅึีจ ีกีตีฝีบีฅีฝ ีกีฝีกีฎ non-garbage-collected ีฌีฅีฆีธึีถีฅึ ีฅีถ, ึ ีกีตีค ีคีฅีบึีธึีด ีฐีซีทีธีฒีธึีฉีตีธึีถีจ ีบีฅีฟึ ีง ีฏีกีฟีกึีพีซ ีดีกีถีธึีกีฌ ีฏีฅึีบีธีพ, ีฐีกีฏีกีผีกีฏ ีคีฅีบึีธึีด ีธึีธีท ีคีฅีบึีฅึีธึีด ีคีก ีฏีกึีธีฒ ีง ีฐีกีถีฃีฅึีถีฅีฌ memory leakึีซึ ิฑีดีฅีถ ีคีฅีบึีธึีด ีถีธึีตีถีซีฝีฏ ีชีกีดีกีถีกีฏีกีฏีซึ JavaScriptึีธึีด ีบีฅีฟึ ีง ีญีธึีฝีกึีฅีฌ ีกีถึีกีถีฏีกีฌีซ referenceึีถีฅึีซ ีบีกีฐีบีกีถีธึีดีซึ, ีธึีจ ีถีธึีตีบีฅีฝ ีฏีกึีธีฒ ีง ีขีฅึีฅีฌ memory leakึีซึ

ีีกีตีฟีถีซ ีง ีธึ JavaScript ีฝีฟีฅีฒีฎีธีฒีจี Brendan Eichึีจ ีซึ 10ึึึีตีก ีฐีกีตีฟีถีซ ีฝีบึีซีถีฟีซ ีกีพีกึีฟีซึ ีฐีฅีฟีธ demo ีฟีกึีขีฅึีกีฏีธึีด ีนีซ ีธึีถีฅึีฅีฌ ีฃึีกีฎ garbage collector, ีธึีจ ีกีพีฅีฌีกึีฅีฌ ีง ีฐีฅีฟีกีฃีกีตีธึีดึ

ิปีถีนีบีฅีฝ ีฅึึีซ ีฐีกีตีฟีถีซ ีงี modern JavaScriptึีจ ีธึีถีซ ีฟีพีตีกีฌีถีฅึีซ 7 ีบึีซีดีซีฟีซีพ ีฟีซีบีฅึ ึ 3 ีฐีฒีดีกีถ ีฟีซีบีฅึโค

**Primitive Types**: String, Boolean, Number, undefined, Symbol, BigInt
ีบีกีฐีพีธึีด ีง stackึีธึีด ึ ีฏีกึีฅีฌีซ ีง access ีฝีฟีกีถีกีฌ ีฐีฅีถึ ีซึีฅีถีธีพ (ีกีผีกีถึ ีฐีฒีดีกีถ)

**Reference Types**: Array, Function, Object
ีกึีชีฅึีจ ีบีกีฐีพีธึีด ีง heapึีธึีด ีซีฝีฏ stackึีธึีด ีบีกีฐีพีธึีด ีง ีฐีฒีธึีดีจ, ีธึีซ ีดีซีปีธึีธีพ ีฏีกึีฅีฌีซ ีง access ีฝีฟีกีถีกีฌ

ิฑีตีชีด, ีกึีคีฅีถ ีซีดีกีถีกีฌีธีพ ีธึ ีฏีธีถีฏึีฅีฟ ึึีซีถีกีฏ ึีธึีถีฏึีซีกีตีซ ีคีฅีบึีธึีด ีกีถีฑีกีดีข ึีธึีถีฏึีซีกีถ ีบีกีฐีพีธึีด ีง heapึีธึีด, ีซีฝีฏ ึีธึีถีฏึีซีกีตีซ ีพึีก ีฐีฒีธึีดีจ (ีธึีธีพ ีฏีกึีฅีฌีซ ีง access ีธึีถีฅีถีกีฌ ีกีตีค ึีธึีถีฏึีซีกีตีซ ีพึีก) ีบีกีฐีพีธึีด ีง stack-ีธึีด, ีฏีกึีธีฒ ีฅีถึ ีกีพีฅีฌีซ ีบีกีฟีฏีฅึีกีพีธึ ีฐีกีฝีฏีกีถีกีฌ ีถีกีญีฏีซีถีธึีด ีฃึีพีกีฎ Hoistingึีซ ึึีซีถีกีฏีจ: ิฑีตีถีฟีฅีฒ ีถีฏีกึีกีฃึีพีกีฎ ีงึ ีดีซ ึึีซีถีกีฏ, ีฉีฅ ีซีถีนีบีฅีฝ ีง ีฝีฟีกึีพีธึีด, ีธึ execution contextึีซ initialization/creation phaseึีธึีด ึีธึีถีฏึีซีกีถ ีฃึีกีถึีพีธึีด ีธึ ีกึีคีฅีถ execution phaseึีธึีด ีฐีกีฝีกีถีฅีฌีซ ีฌีซีถีธึีด, ีนีถีกีตีกีฎ ีธึ var ึ let/const ึีธึีธีญีกีฏีกีถีถีฅึีจ ีซึีฅีถึ ีกีตีฌ ีฏีฅึีบ ีงีซีถ ีคึีฝึีธึีธึีดึ

ิฑีตีชีด ีคีซีฟีกึีฏีฅีถึ ึึีซีถีกีฏ, ีธึีฟีฅีฒ ีธึีถีฅีถึ ึีขีตีฅีฏีฟ, ีธึ ีคึีก ีพึีก ีฏีกีฟีกึีธึีด ีฅีถึ ีธึีธีทีกีฏีซ ีดีกีถีซีบีธึีฌีตีกึีซีกีถีฅึโค

```javascript
// variables case
let a = 2;
let b = a;
a = 5;
console.log(b); // ---------------------- 2
```

```javascript
// objects case
let car = {
  maxSpeed: 200,
  wheelsInch: 17
};
let anotherCar = car;
car.maxSpeed = 240;
console.log(anotherCar.maxSpeed); // ---- 240
anotherCar.wheelsInch = 18;
console.log(car.wheelsInch); // --------- 18
```

ิปีถีนีบีฅีฝ ีฟีฅีฝีถีธึีด ีฅีถึี ึีธึีธีญีกีฏีกีถีซ ีคีฅีบึีธึีด ีฟีพีตีกีฌีจ ึีธีญีธึีด ีง ีฐีฅีถึ ีซึ ีกึีชีฅึีจ, ีซีฝีฏ ึีขีตีฅีฏีฟีจ (ีฐีฒีธึีด ีธึีถีฅึีธีฒ ีฟีพีตีกีฌีจ) ีฏีกีผีกีพีกึีพีธึีด ีง ีซึ ีพึีก ีธึีถีฅึีกีฎ ีฐีฒีธึีดีธีพึ ีึีซีถีกีฏ, ีฅึีข ีฝีฟีฅีฒีฎีธึีด ีฅีถึ ีถีธึ ึีขีตีฅีฏีฟี ีถึีกีถ ีพีฅึีกีฃึีฅีฌีธีพ ีถีกีญีฏีซีถีธึีด ีธึีถีฅึีกีฎ ึีขีตีฅีฏีฟีจ, ีกีบีก ีกีตีฝ ีคีฅีบึีธึีด deep copy ีนีซ ีกึีพีธึีด (ีฐีซีถ ึีขีตีฅีฏีฟีซ ีฏีธีถีฟีฅีถีฟีจ), ีกีตีฌ ีจีถีคีกีดีฅีถีจ ีฝีฟีฅีฒีฎีพีธึีด ีง ีถีธึ ีฐีฒีธึีด, ีธึีจ ีธึีถีซ ีถีธึีตีถ accessึีจ ีฟีพีตีกีฌ ึีขีตีฅีฏีฟีซ ีพึีก, ีซีถีนีบีฅีฝ ีธึีถีฅึ ีถีกีญีฏีซีถีธึีด ีฐีกีตีฟีกึีกึีพีกีฎีจึ ีีฟีกึีพีธึีด ีง, ีธึ carึีถ ีงีฌ, anotherCarึีถ ีงีฌ ีฅึีฏีธึีฝีถ ีงีฌ ีฆีธึีฟ heapึีธึีด ีฅีฒีกีฎ ึีขีตีฅีฏีฟีซ ีพึีก ีฐีกีฝีกีถีฅีฌีซีธึีฉีตีธึีถ ีธึีถีฅีถีกีฌีธึ ีฐีถีกึีกีพีธึีธึีฉีตีธึีถ ีฅีถึ
ีีฏีกึีกีฃึีพีกีฎ ึึีซีถีกีฏีซ ีฐีกีดีกึ ีฏีธึีถีฅีถีกีถึ ีฐีฅีฟึีตีกีฌ ีบีกีฟีฏีฅึีจโค

<img src="https://i.imgur.com/IPHaiWJ.png" style="width:100%;">
 
[ีีฏีกึีธึีด ีกีตีถ ีฝีบีฅึีซึีซีฏ ีบีกีฐีถ ีง, ีธึีฟีฅีฒ ีคีฅีผ ีพีฅึีกีฃึีธึีดีถีฅึ ีนีฅีถ ีกึีพีฅีฌ]

ีีฅึีปีธึีด, ีดีซีฃีธึึีฅ ีธึีบีฅีฝ ีฌึีกึีธึึีซีน ีถีตีธึีฉ, ีธึีถีฅีถีกีถึ JavaScriptึีธึีด ีกีทีญีกีฟีกีถึีซีถ ีถีพีซึีพีกีฎ ีฌีฅีฏึีซีกีตีซ [ีฐีฒีธึีด](https://www.youtube.com/watch?v=Aa_OWn03mDo&list=PLEzQf147-uEpvTa1bHDNlxUL2klHUMHJu&index=116&t=256s), ีธึีจ ีฏีกึีธีฒ ีง ีฌีซีถีฅีฌ ีฐีกีถีฃีกีดีกีถึ, ีธึีจ ีฉีธึีตีฌ ีฏีฟีก JavaScript ึีธึีถีฏึีซีกีถีฅึีซีถ "ีถีกีตีฅีฌ ีกีตีฌ ีฐีกีตีกึึีธีพ":

<img src="https://i.imgur.com/JmjCmvW.png" style="width:100%;">
 
[[Douglas Crockford](https://www.crockford.com/): Fun With Functions]

ีีฟีธึึ ีกีตีถ ึีฃีฟีกีฏีกึ ีผีฅีฝีธึึีฝีถีฅึีซ ีฐีฒีธึีดีถีฅึ ีฅีถ, ีธึีธีถึ ีธึีฒีฒีกีฏีซีธึีฅีถ ีฟีฅีฒ ีนีฃีฟีกีถ ีกีตีฝ ีดีกีฝีธึีด, ีขีกีตึ ีฏีกีบีพีกีฎ ีฅีถ ีฟีพีตีกีฌ ีฉีฅีดีกีตีซ ีฐีฅีฟโค

- [JavaScript Execution Context](https://luigicruz.dev/blog/execution-context) [Apr, 2021]
- [JavaScript Execution Context - How JS Works Behind The Scenes](https://www.freecodecamp.org/news/execution-context-how-javascript-works-behind-the-scenes/) [Feb, 2022]

NGNTJS ีฐีธีคีพีกีฎีถีฅึีซ ีทีกึึีซ ีกีตีฝ ีดีกีฝีธึีด ีถีฅึีฏีกีตีกึีพีฅึ JavaScriptึีธึีด Execution Contextึีจ, ีคึีก memory creation ึ execution phaseึีฅึีจ, ีถีฏีกึีกีฃึีพีฅึ call stackึีซ ีกีทีญีกีฟีกีถึีจ ีฃีธึีฎีถีกีฏีกีถ ึึีซีถีกีฏีถีฅึีซ ีดีซีปีธีฒีธีพ, ีซีถีนีบีฅีฝ ีถีกึ ึีธึีธีญีกีฏีกีถีถีฅึีซ ึ ีฐีฒีธึีดีถีฅึีซ ีฟีซีบีฅึีจ:
ีีกีปีธึีคี [ีดีกีฝ 4](https://medium.com/@boolfalse/libuv-event-loop-%D5%AE%D5%A1%D5%B6%D5%B8%D5%A9%D5%B8%D6%82%D5%A9%D5%B5%D5%B8%D6%82%D5%B6-886772ab3df)ึีธึีด ีฏีคีซีฟีกึีฏีฅีถึ libUV ีฃึีกีคีกึีกีถีจ, ีซีถีนีบีฅีฝ ีถีกึ ีฏีฌีซีถีซ ีฎีกีถีธีฉีธึีฉีตีธึีถ event-loop ีดีฅีญีกีถีซีฆีดีซ ีกีทีญีกีฟีกีถึีซ ีฐีฅีฟึ

***

ิตีฉีฅ ีฐีกีพีกีถีฅึีซึ ีกีตีฝ ีถีตีธึีฉีจ, ีกีฆีกีฟ ีฏีกึีธีฒ ีฅึ ีฐีฅีฟึีฅีฌ ีซีถีฑ ีกีตีฝีฟีฅีฒึ ๐

ิบีกีดีกีถีกีฏีกีฏีซึ ีฟีกึีขีฅึ ีฟีฅีญีถีธีฌีธีฃีซีกีถีฅึีธีพ ีกีทีญีกีฟีธีฒ ีบึีธีตีฅีฏีฟีถีฅึ ีธึีฝีธึีดีถีกีฝีซึีฅีฌีธึ ีฐีกีดีกึ ีฏีกึีธีฒ ีฅึ ีฐีฅีฟึีฅีฌ ีซีด [GitHub](https://github.com/boolfalse) ีงีปีซีถ, ีธึีฟีฅีฒ ีฅีฝ ีกีฏีฟีซีพีธึีฅีถ ีฐีกีถึีกีตีถีกึีถีธึีด ีฅีด ีซีด ีฏีกีฟีกึีกีฎ ีกีทีญีกีฟีกีถึีซ ีฆีฃีกีฌีซ ีดีกีฝีจึ

ิฑีตีฌ ีซีถึีธีซ ีฐีกีดีกึ ีฏีกึีธีฒ ีฅึ ีกีตึีฅีฌีฅีฌ ีซีด ึึีซึีซีกีฌ ีฏีกีตึ` [https://boolfalse.com/](https://boolfalse.com/)
